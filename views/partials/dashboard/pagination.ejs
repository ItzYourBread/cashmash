<% 
  // Ensure total_pages is at least 1
  if (totalPages > 1) { 
    let startPage = Math.max(1, currentPage - 2); 
    let endPage = Math.min(totalPages, currentPage + 2); 
    
    if (totalPages > 5) {
      if (currentPage <= 3) { startPage = 1; endPage = 5; } 
      else if (currentPage >= totalPages - 2) {
        startPage = totalPages - 4;
        endPage = totalPages;
      }
    }
%>
<div class="pagination-controls">
  <% if (currentPage > 1) { %>
    <a href="/dashboard?section=<%= sectionId %>&page=<%= currentPage - 1 %>" class="btn">&laquo;</a>
  <% } else { %>
    <span class="btn disabled">&laquo;</span>
  <% } %>

  <% for (let i = startPage; i <= endPage; i++) { %>
    <a href="/dashboard?section=<%= sectionId %>&page=<%= i %>" class="btn <%= i === currentPage ? 'active' : '' %>">
      <%= i %>
    </a>
  <% } %>

  <% if (currentPage < totalPages) { %>
    <a href="/dashboard?section=<%= sectionId %>&page=<%= currentPage + 1 %>" class="btn">&raquo;</a>
  <% } else { %>
    <span class="btn disabled">&raquo;</span>
  <% } %>
</div>
<% } %>