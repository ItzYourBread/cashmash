<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    <%= slotsConfig[slotType].title %> | CashMash
  </title>

  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/header.css" />
  <link rel="stylesheet" href="/css/footer.css" />
  <link rel="stylesheet" href="/css/slots.css" />
</head>

<body>
  <%- include('partials/header') %>

  <%- include('partials/gameLoader') %>


    <section class="slots-section">
      <div class="slot-machine">
        <h2 class="neon-title">
          <%= slotsConfig[slotType].title %>
        </h2>

        <div class="slot-canvas-wrapper">
          <canvas id="slotCanvas" data-slot-type="<%= slotType %>"></canvas>
        </div>

        <!-- ðŸ† Result Display -->
        <div class="slot-result" id="slotResult">
          <div class="result-text" id="resultText">Best of Luck</div>
        </div>

        <div class="slot-controls">
          <input type="hidden" id="betAmount" value="<%= slotsConfig[slotType].minBet %>">
          <button id="spinBtn" style="display: none;">Spin Hidden</button>

          <!-- Balance + Bet Display -->
          <div class="balance-container">
            <div class="balance-text">Balance: $<span id="balance" data-raw-balance="<%= user.balance %>">
                <%= formatBalance(user.balance) %>
              </span></div>
            <!-- Added bet-text class for clickability on the displayed bet amount -->
            <div class="bet-text">Bet: $<span id="liveBet">
                <%= slotsConfig[slotType].minBet %>
              </span></div>
          </div>

          <div class="result-amount" id="resultAmount"></div>

          <!-- Bet + Spin -->
          <div class="bet-spin-container">
            <button class="bet-btn" id="betMinus">âˆ’</button>
            <div class="bet-spin-btn" id="betSpinBtn">SPIN</div>
            <button class="bet-btn" id="betPlus">+</button>
          </div>
        </div>
        <div class="info-icon" id="infoBtn">?</div>

        <!-- ðŸ’° Bet Modal (UPDATED STRUCTURE) -->
        <div id="betModal" class="bet-modal">
          <div class="bet-modal-content">
            <h2>Set Bet Amount</h2>

            <!-- Bet Options (Buttons generated by JS) -->
            <div class="bet-options">
              <!-- JS will populate fixed bet buttons here -->
            </div>

            <!-- Manual entry with "Set" button -->
            <div class="custom-bet-input">
              <input type="number" id="manualBetInput" min="<%= slotsConfig[slotType].minBet %>"
                max="<%= slotsConfig[slotType].maxBet %>" placeholder="Enter bet" />
            </div>
          </div>
        </div>
      </div>
    </section>

      <div id="infoModal" class="modal"></div>


    <%- include('partials/footer') %>
      <script>
        window.slotsConfig = <%- JSON.stringify(slotsConfig) %>;
        window.currentSlot = "<%= slotType %>";
      </script>

      <script src="/js/formatBalance.js"></script>
      <script src="/js/slotEngine.js"></script>
      <script src="/js/slotsModal.js"></script>
</body>

</html>

<style>
  <%=slotsConfig[slotType].theme %>
</style>