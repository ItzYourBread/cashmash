<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pharaoh's Riches | CashMash</title>
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/header.css" />
  <link rel="stylesheet" href="/css/footer.css" />
  <link rel="stylesheet" href="/css/slots.css" />
</head>

<body>
  <%- include('partials/header') %>

    <section class="slots-section">
      <div class="slot-machine">
        <h2 class="neon-title">Pharaoh's Riches Slot Machine</h2>

        <div class="slot-canvas-wrapper">
          <canvas id="slotCanvas"></canvas>
        </div>

        <div class="controls">
          <div class="balance-container">
            Balance: ৳<strong id="balance">
              <%= user.chips %>
            </strong>
          </div>

          <div class="bet-section">
            <input type="number" id="betAmount" placeholder="50-2000" min="50" max="2000" value="50" />
            <button id="spinBtn" class="btn gold big">SPIN</button>
          </div>

          <div class="info-icon" id="infoBtn">?</div>
        </div>

        <p id="result">Place your bet and spin!</p>
      </div>
    </section>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2>Winning Info</h2>
        <p>Payouts require 5-of-a-kind on any of the 14 active paylines.</p>

        <h3>Multipliers (5-of-a-Kind)</h3>
        <ul>
          <li><img src="/images/PharaohsRichesSlots/pharaoh.png" alt="Pharaoh" class="mini-symbol" /> Pharaoh: x5</li>
          <li><img src="/images/PharaohsRichesSlots/sphinx.png" alt="Sphinx" class="mini-symbol" /> Sphinx: x4</li>
          <li><img src="/images/PharaohsRichesSlots/ankh.png" alt="Ankh" class="mini-symbol" /> Ankh: x3.5</li>
          <li><img src="/images/PharaohsRichesSlots/eyeOfHorus.png" alt="Eye of Horus" class="mini-symbol" /> Eye of
            Horus: x3</li>
          <li><img src="/images/PharaohsRichesSlots/scarab.png" alt="Scarab" class="mini-symbol" /> Scarab: x2.5</li>
          <li><img src="/images/PharaohsRichesSlots/pyramid.png" alt="Pyramid" class="mini-symbol" /> Pyramid: x2</li>
          <li><img src="/images/PharaohsRichesSlots/goldCoin.png" alt="Gold Coin" class="mini-symbol" /> Gold Coin: x1.5
          </li>
          <li><img src="/images/PharaohsRichesSlots/treasureChest.png" alt="Treasure Chest" class="mini-symbol" />
            Treasure Chest: x1.2</li>
          <li><img src="/images/PharaohsRichesSlots/hieroglyphScroll.png" alt="Hieroglyph Scroll" class="mini-symbol" />
            Hieroglyph Scroll: x1</li>
          <li><img src="/images/PharaohsRichesSlots/ra.png" alt="Ra" class="mini-symbol" /> Ra: x10</li>
        </ul>
      </div>
    </div>

    <%- include('partials/footer') %>
      <script type="module" src="/js/PharaohsRichesSlots.js"></script>
      <script type="module" src="/js/slotsModal.js"></script>
      <script>
        const betInput = document.getElementById('betAmount');
        const spinBtn = document.getElementById('spinBtn');
        const minBet = 50;
        const maxBet = 2000;

        // Check bet when user leaves input field
        betInput.addEventListener('blur', () => {
          validateBet();
        });

        // Check bet before spinning
        spinBtn.addEventListener('click', (e) => {
          const valid = validateBet();
          if (!valid) e.preventDefault();
        });

        function validateBet() {
          let value = parseInt(betInput.value, 10);
          const result = document.getElementById('result');

          if (isNaN(value)) value = minBet;

          if (value < minBet) {
            betInput.value = minBet;
            showWarning(`Minimum bet is ৳${minBet}`);
            return false;
          } else if (value > maxBet) {
            betInput.value = maxBet;
            showWarning(`Maximum bet is ৳${maxBet}`);
            return false;
          }
          betInput.classList.remove('input-warning');
          result.textContent = "Place your bet and spin!";
          result.style.color = "#fff";
          return true;
        }

        function showWarning(msg) {
          const result = document.getElementById('result');
          result.textContent = msg;
          result.style.color = "gold";
          betInput.classList.add('input-warning');
          setTimeout(() => {
            betInput.classList.remove('input-warning');
          }, 1000);
        }

        // Add a subtle warning style
        const style = document.createElement('style');
        style.textContent = `
    .input-warning {
      border: 2px solid gold;
      box-shadow: 0 0 8px gold;
      transition: all 0.3s ease;
    }
  `;
        document.head.appendChild(style);
      </script>
</body>

</html>