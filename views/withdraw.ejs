<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Withdraw Title Placeholder | CashMash</title>
    <link rel="stylesheet" href="/css/header.css" />
    <link rel="stylesheet" href="/css/footer.css" />
    <link rel="stylesheet" href="/css/dashboard.css" />
    <link rel="stylesheet" href="/css/payment.css" />
</head>

<body>
    <%- include('partials/header') %>
        <section class="dashboard">
            <div class="dashboard-container">
                <aside class="sidebar">
                    <div class="balance-box">
                        <h3>Balance</h3>
                        <% if (user) { %>
                            <p id="userBalanceDisplay">
                                $<%= user.balance.toLocaleString() %>
                            </p>
                            <% } else { %>
                                <p>Login to see balance</p>
                                <% } %>
                    </div>
                    <ul class="sidebar-menu">
                        <li class="active" data-tab="ewallets">E-Wallets</li>
                        <li data-tab="crypto">Crypto</li>
                        <li data-tab="bank">Bank</li>
                    </ul>
                </aside>
                <div class="content-area">
                    <div id="ewallets" class="content-section active">
                        <h2>E-Wallets</h2>
                        <div class="payment-cards">
                            <div class="payment-card" data-modal="modal-bkash">
                                <img src="/images/payments/bkash.jpg" alt="Bkash">
                                <h4>Bkash</h4>
                            </div>
                            <div class="payment-card" data-modal="modal-nagad">
                                <img src="/images/payments/nagad.jpg" alt="Nagad">
                                <h4>Nagad</h4>
                            </div>
                            <div class="payment-card" data-modal="modal-upay">
                                <img src="/images/payments/upay.jpg" alt="Upay">
                                <h4>Upay</h4>
                            </div>
                            <div class="payment-card" data-modal="modal-binance">
                                <img src="/images/payments/binance.jpg" alt="Binance">
                                <h4>BinancePay</h4>
                            </div>
                        </div>
                    </div>
                    <div id="crypto" class="content-section">
                        <h2>Crypto</h2>
                        <h2 style="margin-top: 20px;">Coming Soon...</h2>
                    </div>
                    <div id="bank" class="content-section">
                        <h2>Bank</h2>
                        <h2 style="margin-top: 20px;">Coming Soon...</h2>
                    </div>
                </div>
            </div>
        </section>

        <% ['bkash', 'nagad' , 'upay' ].forEach(method=> { %>
            <div id="modal-<%= method %>" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h3>
                        <%= method.charAt(0).toUpperCase() + method.slice(1) %> Withdraw
                    </h3>
                    <form method="POST" action="/withdraw/<%= method %>">
                        <label>Full Name</label>
                        <input type="text" name="fullName" required>
                        <label>
                            <%= method.charAt(0).toUpperCase() + method.slice(1) %> Number
                        </label>
                        <input type="text" name="contact" required>
                        <label>Amount (USD)</label>
                        <input type="number" name="amount" id="<%= method %>Amount" required min="10">
                        <div id="<%= method %>Feedback" class="amount-feedback"></div>

                        <p>Withdrawal processing time</p>
                        <button type="submit" id="<%= method %>ConfirmBtn" disabled>Confirm</button>
                    </form>
                </div>
            </div>
            <% }) %>

                <div id="modal-binance" class="modal">
                    <div class="modal-content">
                        <span class="close">&times;</span>
                        <h3>BinancePay Withdraw</h3>
                        <form method="POST" action="/withdraw/binance">
                            <label>Email or User ID</label>
                            <input type="text" name="userIdOrEmail" required>
                            <label>Amount (USD)</label>
                            <input type="number" name="amount" id="binanceAmount" required min="10">
                            <div id="binanceFeedback" class="amount-feedback"></div>

                            <p>Withdrawal processing time</p>
                            <button type="submit" id="binanceConfirmBtn" disabled>Confirm</button>
                        </form>
                    </div>
                </div>

                <div class="login-modal" id="loginModal">
                    <div class="login-modal-content">
                        <h2>Login Required</h2>
                        <p>You need to be logged in to withdraw USD.</p>
                        <div class="login-modal-actions">
                            <a href="/login" class="login-btn gold">Login</a>
                            <button class="login-btn outline" id="closeLoginModal">Cancel</button>
                        </div>
                    </div>
                </div>
                <%- include('partials/footer') %>
                    <script>
                        // Server-side user login check logic is retained
                        const isLoggedIn = <%= user ? 'true' : 'false' %>;

                    </script>
                    <script src="/js/withdraw.js"></script>

</body>

</html>